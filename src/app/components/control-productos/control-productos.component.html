<div class="card">
  <p-tabView>
    <p-tabPanel header="Materias Primas">
      <div class="card">
        <div class="buscador">
          <h2 class="tituloTabla">Materias Primas</h2>
          <span class="p-input-icon-left">
              <i class="pi pi-search"></i>
              <input style="border-radius: 20px;" type="text" placeholder="Buscar" pInputText [(ngModel)]="value2" (input)="applyFilter2()" />
            </span>
        </div>
        <p-table  [value]="materias" [paginator]="true" [rows]="5" [showCurrentPageReport]="true"
            [tableStyle]="{ 'min-width': '50rem' }"
            currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
            [rowsPerPageOptions]="[5, 10, 20]">

            <ng-template pTemplate="header">

              <tr>
        <!-- <th pSortableColumn="id" style="width:20%">#<p-sortIcon field="id"></p-sortIcon></th> -->
                <th pSortableColumn="nombre" style="width:20%">Nombre <p-sortIcon field="id_producto"></p-sortIcon></th>
                <th pSortableColumn="costo" style="width:20%">Costo <p-sortIcon field="cantidad"></p-sortIcon></th>
                <th pSortableColumn="stock" style="width:20%">Stock <p-sortIcon field="nombre"></p-sortIcon></th>
                <th pSortableColumn="nombre_unidad" style="width:20%">Unidad <p-sortIcon field="precio_unitario"></p-sortIcon></th>
                <th pSortableColumn="acciones" style="width:20%">Acciones <p-sortIcon field="Acciones"></p-sortIcon></th>

              </tr>
            </ng-template>
            <ng-template pTemplate="body" let-materias>
              <tr>
                <!-- <td>{{ materias.id }}</td> -->
                <td>{{ materias.nombre }}</td>
                <td>{{ materias.costo }}</td>
                <td>{{ materias.stock }}</td>
                <td>{{ materias.nombre_unidad }}</td>
                <th>
                  <p-button label="Editar" (click)="editMateria(materias.id)"></p-button>
                  <p-button label="Eliminar" severity="danger" (click)="eliminarMateria(materias.id)"></p-button>
                </th>
              </tr>
            </ng-template>
            <ng-template pTemplate="paginatorleft">
              <p-speedDial [model]="items3" direction="right"></p-speedDial>
            </ng-template>
            <ng-template pTemplate="paginatorright"></ng-template>
          </p-table>
      </div>
    </p-tabPanel>

    <p-tabPanel header="Mermas">
      <div class="card">
        <div class="buscador">
          <h2 class="tituloTabla">Mermas</h2>
          <span class="p-input-icon-left">
              <i class="pi pi-search"></i>
              <input style="border-radius: 20px;" type="text" placeholder="Buscar" pInputText [(ngModel)]="value" (input)="applyFilter3()" />
            </span>
        </div>
        <p-table  [value]="mermas" [paginator]="true" [rows]="5" [showCurrentPageReport]="true"
            [tableStyle]="{ 'min-width': '50rem' }"
            currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
            [rowsPerPageOptions]="[5, 10, 20]">

            <ng-template pTemplate="header">

              <tr>

                <th pSortableColumn="nombre" style="width:20%">Nombre <p-sortIcon field="nombre"></p-sortIcon></th>
                <th pSortableColumn="cantidad" style="width:20%">Monto de merma <p-sortIcon field="cantidad"></p-sortIcon></th>
                <th pSortableColumn="nombre_unidad" style="width:20%">Unidad de Merma <p-sortIcon field="nombre_unidad"></p-sortIcon></th>
                <th pSortableColumn="precio_unitario" style="width:20%">Motivo <p-sortIcon field="precio_unitario"></p-sortIcon></th>
                <th pSortableColumn="Acciones" style="width:20%">Acciones <p-sortIcon field="Acciones"></p-sortIcon></th>
              </tr>
            </ng-template>
            <ng-template pTemplate="body" let-mermas>
              <tr>

                <td>{{ mermas.nombre_producto  }}</td>
                <td>{{ mermas.monto_mermado }}</td>
                <td>{{ mermas.nombre_unidad }}</td>
                <td>{{ mermas.causa }}</td>
                <td>
                  <p-button label="Editar" (click)="editMerma(mermas.id)"></p-button>
                  <p-button label="Eliminar" severity="danger" (click)="eliminarMerma(mermas.id)"></p-button>
                </td>


              </tr>
            </ng-template>

            <ng-template pTemplate="paginatorleft">
              <p-speedDial [model]="items2" direction="right"></p-speedDial>

            </ng-template>
            <ng-template pTemplate="paginatorright"></ng-template>
          </p-table>

      </div>
    </p-tabPanel>


    <p-tabPanel header="Productos">
      <div class="card">
        <div class="buscador">
          <h2 class="tituloTabla">Productos</h2>
          <span class="p-input-icon-left">
            <i class="pi pi-search"></i>
            <input style="border-radius: 20px;" type="text" placeholder="Buscar" pInputText [(ngModel)]="value"
              (input)="applyFilter()" />
          </span>
        </div>
        <p-table [value]="productos" [paginator]="true" [rows]="5" [showCurrentPageReport]="true"
          [tableStyle]="{ 'min-width': '50rem' }"
          currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
          [rowsPerPageOptions]="[5, 10, 20]">
          <ng-template pTemplate="header">
            <tr>

              <th pSortableColumn="id_producto" style="width:20%">#Producto <p-sortIcon
                  field="id_producto"></p-sortIcon></th>
              <th pSortableColumn="nombre_producto" style="width:20%">Nombre <p-sortIcon
                  field="nombre_producto"></p-sortIcon></th>
              <th pSortableColumn="nombre_unidad" style="width:20%">Unidad<p-sortIcon
                  field="nombre_unidad"></p-sortIcon></th>
              <th pSortableColumn="precio" style="width:20%">Precio <p-sortIcon field="precio"></p-sortIcon></th>
              <th pSortableColumn="acciones" style="width:20%">Acciones <p-sortIcon field="Acciones"></p-sortIcon></th>

            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-productos>
            <tr>

              <td>{{ productos.id_producto }}</td>
              <td>{{productos.nombre_producto }}</td>
              <td>{{ productos.nombre_unidad }}</td>
              <td>{{productos.precio }}</td>
              <td>
                <p-button label="Editar" (click)="editProducto(productos.id_producto, productos.id_unidad)"></p-button>
                <p-button label="Eliminar" severity="danger" (click)="eliminarProducto(productos.id_producto)"></p-button>
              </td>
            </tr>
          </ng-template>
          <ng-template pTemplate="paginatorleft">
            <p-speedDial [model]="items" direction="right"></p-speedDial>
          </ng-template>
          <ng-template pTemplate="paginatorright"></ng-template>
        </p-table>
      </div>
    </p-tabPanel>
  </p-tabView>
</div>


<p-dialog header="Registro de productos" [(visible)]="visible" [modal]="true" [style]="{ width: '50vw' }" [draggable]="false" [resizable]="false">
  <form (ngSubmit)="registrarProducto()" autocomplete="off">
    <div class="p-field">
      <span class="p-float-label">
        <input id="nombre" type="text" pInputText [(ngModel)]="nombre" name="nombre" required>
        <label class="label" for="nombre">Nombre Producto</label>
      </span>
    </div>
    <p-toast key="toast"></p-toast>
    <button mat-raised-button id="btn-login" type="submit">Guardar</button>
  </form>
</p-dialog>

<p-dialog header="Editar de productos" [(visible)]="visible2" [modal]="true" [style]="{ width: '50vw' }" [draggable]="false" [resizable]="false">
  <form (ngSubmit)="editarProducto()" autocomplete="off">
    <div class="p-field">
      <span class="p-float-label">
        <input id="idEditar" type="text" pInputText [(ngModel)]="idEditar" name="idEditar" required style="display: none;">
        <input id="idUnidadEditar" type="text" pInputText [(ngModel)]="idUnidadEditar" name="idUnidadEditar" required style="display: none;">
        <input id="nombreEditar" type="text" pInputText [(ngModel)]="nombreEditar" name="nombreEditar" required>
        <label class="label" for="nombreEditar">Nombre Producto</label>
      </span>
    </div>
    <p-toast key="toast"></p-toast>
    <button mat-raised-button id="btn-login" type="submit">Guardar</button>
  </form>
</p-dialog>

<p-dialog header="Registro de mermas" [(visible)]="visible3" [modal]="true" [style]="{ width: '50vw' }" [draggable]="false" [resizable]="false">
  <form (ngSubmit)="registrarProducto()" autocomplete="off">
    <div class="p-field">
      <span class="p-float-label">
        <input id="monto_mermado" type="number" pInputText [(ngModel)]="monto_mermado" name="monto_mermado" required>
        <label class="label" for="monto_mermado">Monto mermado</label>
      </span>
    </div>
    <div class="p-field">
      <span class="p-float-label">
        <input id="causa" type="text" pInputText [(ngModel)]="causa" name="causa" required>
        <label class="label" for="causa">Causa</label>
      </span>
    </div>
    <div class="p-field">
      <p-toast key="toast"></p-toast>
      <button mat-raised-button id="btn-login" type="submit">Guardar</button>
    </div>
    </form>
</p-dialog>

<p-dialog header="Editar de mermas" [(visible)]="visible4" [modal]="true" [style]="{ width: '50vw' }" [draggable]="false" [resizable]="false">
  <form (ngSubmit)="editarProducto()" autocomplete="off">
    <div class="p-field">
      <span class="p-float-label">
        <input id="idEditar" type="text" pInputText [(ngModel)]="idEditar" name="idEditar" required>
        <input id="idUnidadEditar" type="text" pInputText [(ngModel)]="idUnidadEditar" name="idUnidadEditar" required>
        <input id="nombreEditar" type="text" pInputText [(ngModel)]="nombreEditar" name="nombreEditar" required>
        <label class="label" for="nombreEditar">Nombre Producto</label>
      </span>
    </div>
    <p-toast key="toast"></p-toast>
    <button mat-raised-button id="btn-login" type="submit">Guardar</button>
  </form>
</p-dialog>

<p-dialog header="Registro de materias primas" [(visible)]="visible5" [modal]="true" [style]="{ width: '50vw' }" [draggable]="false" [resizable]="false">
  <form (ngSubmit)="registrarMateria()" autocomplete="off">
    <div class="p-field">
      <span class="p-float-label">
        <input id="monto_mermado" type="number" pInputText [(ngModel)]="monto_mermado" name="monto_mermado" required>
        <label class="label" for="monto_mermado">Monto mermado</label>
      </span>
    </div>  

    <div class="p-field">
      <span class="p-float-label">
        <input id="causa" type="text" pInputText [(ngModel)]="causa" name="causa" required>
        <label class="label" for="causa">Causa</label>
      </span>
    </div>
    
    <p-toast key="toast"></p-toast>
    <button mat-raised-button id="btn-login" type="submit">Guardar</button>
  </form>
</p-dialog>

<p-dialog header="Editar materias primas" [(visible)]="visible6" [modal]="true" [style]="{ width: '50vw' }" [draggable]="false" [resizable]="false">
  <form (ngSubmit)="editarMateria()" autocomplete="off">
    <div class="p-field">
      <span class="p-float-label">
        <input id="nombre_merma" type="text" pInputText [(ngModel)]="nombre_merma" name="nombre_merma" required >
        <label class="label" for="nombre_merma">Causa</label>
      </span>
    </div>
    <div class="p-field">
      <span class="p-float-label">
        <input id="costo" type="text" pInputText [(ngModel)]="costo" name="costo" required >
        <label class="label" for="causa">Causa</label>
      </span>
    </div>

    <div class="p-field">
      <span class="p-float-label">
        <div class="card flex justify-content-center">
          <p-treeSelect class="md:w-20rem w-full" containerStyleClass="w-full" [(ngModel)]="selectedNodes" [options]="nodes" placeholder="Select Item"></p-treeSelect>
        </div>
      </span>
    </div>

    

    <div class="p-field">
      <span class="p-float-label">
        <input id="stock" type="text" pInputText [(ngModel)]="stock" name="stock" required >
        <label class="label" for="stock">Stock</label>
      </span>
    </div>
    <p-toast key="toast"></p-toast>
    <button mat-raised-button id="btn-login" type="submit">Guardar</button>
  </form>
</p-dialog>


